<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Details</title>
    <link rel="stylesheet" href="/styles.css" />
</head>
<body>

<div class="d-page">
    <button id="returnbtn"> < Go Back</button>
<h2 id="doc_title" class="title-field"></h2>
<div class="details">

    <div class="scrollable">
        <h3>Contents</h3>
        <p id="doc_content" class="field"></p>
    </div>
    <div class="static">
        <h3>Gemini AI Summary</h3>
        <p id="ai_summary" class="field">insert gemini summary here</p>
    </div>
</div>
</div>
<script>
    async function loadDetail() {
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');
        if (!id) {
            document.getElementById('title').textContent = 'No ID provided';
            return;
        }
        document.getElementById('returnbtn').addEventListener('click',  () => {
            window.location.href = `index.html`;
        })
        try {
            const r = await fetch(`/api/docs/${id}`);
            if (!r.ok) {
                document.getElementById('doc_title').textContent = `HTTP ${r.status}`;
                return;
            }
            const item = await r.json();
            document.getElementById('doc_title').textContent = `${item.id}: ${item.title}`;

            var docstring = item.content;
            document.getElementById('doc_content').innerHTML = docstring.replace(/\n/g, "<br><br>")


            //do gemini api call to set the summary
            document.getElementById('ai_summary').textContent = "Summary by Gemini AI goes here"
                ;

        } catch (e) {
            document.getElementById('doc_title').textContent = `Error: ${e}`;
        }
    }

    window.addEventListener('DOMContentLoaded', loadDetail);
</script>

</body>
</html>